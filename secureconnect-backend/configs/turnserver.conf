# Coturn TURN Server Configuration
# Production-ready TURN/STUN server for SecureConnect

# Listening port for STUN/TURN (UDP and TCP)
listening-port=3478
tls-listening-port=5349

# Alternative ports for better NAT traversal
alt-listening-port=3479
alt-tls-listening-port=5350

# External IP configuration (REQUIRED FOR PRODUCTION)
# Format: external-ip=PUBLIC_IP/PRIVATE_IP
# Example: external-ip=203.0.113.1/10.0.0.5
# TODO: Set your actual public and private IPs before deployment
external-ip=YOUR_PUBLIC_IP/YOUR_PRIVATE_IP

# Fingerprinting (for DTLS)
fingerprint

# Use long-term credentials (recommended for production)
lt-cred-mech

# Realm (authentication domain)
realm=secureconnect

# Total quota limit (in bytes)
total-quota=100

# STUN and TURN both enabled (removed conflicting directives)
# Clients can use STUN for discovery and TURN for relay

# Verbose logging disabled for production
# Enable only for debugging: verbose
# log-file=/var/log/turnserver/turnserver.log

# Simple log format
simple-log

# Enable IPv6 (optional, comment out if not needed)
# ipv6

# Secure STUN (TURN with TLS)
# cert=/etc/turnserver/cert.pem
# pkey=/etc/turnserver/pkey.pem
# ca-file=/etc/turnserver/ca.pem

# DH TLS key size (2048 or 4096)
dh2066

# Mobility with ICE (MICE)
mobility

# Channel binding (RFC 5766)
channel-binding

# No-loopback-peers (prevent connections to self)
no-loopback-peers

# No-multicast-peers (prevent multicast)
no-multicast-peers

# Max message size (in bytes)
max-bps=3000000

# Min port for UDP relay allocations
# Changed to 50100 to avoid port 50071 conflict
min-port=50100

# Max port for UDP relay allocations
# Limited to 50150 to limit port range to 50 ports (prevents 100% CPU/RAM/Disk usage)
max-port=50150

# Redis for user authentication (optional, for dynamic credentials)
# redis-statsdb="ip=redis port=6379"

# Use Redis for user database
# userdb=/var/lib/turn/turndb

# Static user credentials (for development/testing)
# Format: user=username:password
# Production: Use Redis or database for dynamic credentials
# user=turnuser:turnpassword

# Time to live for allocations (in seconds)
# Default is 600 seconds (10 minutes)
# stale-nonce=600

# Deny Peer IP (for security)
# denied-peer-ip=0.0.0.0-0.255.255.255
# denied-peer-ip=10.0.0.0-10.255.255.255
# denied-peer-ip=127.0.0.0-127.255.255.255
# denied-peer-ip=172.16.0.0-172.31.255.255
# denied-peer-ip=192.168.0.0-192.168.255.255

# Allowed Peer IP (whitelist)
# allowed-peer-ip=203.0.113.0/24

# CLI password for turnadmin
# cli-password=your_cli_password

# Web admin (optional)
# web-admin-ip=127.0.0.1
# web-admin-port=8080
# web-admin-user=admin
# web-admin-password=admin

# Prometheus metrics (optional)
# prometheus

# Prometheus metrics port
# prometheus-port=9641
